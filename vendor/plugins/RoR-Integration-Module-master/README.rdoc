= Clicktale

== Summary

This plugin allows easy integration with Clicktale service
(http://clicktale.com).  Clicktale records user sessions, clicks, form input
etc and plays them back later for usability review.

== Big Thanks

This version of the plugin is a major rewrite with much more features, better
integration with clicktale service and pink invisible unicorns playfully dancing
all over it.

And the big thanks for this goes to clicktale guys that initiated and sponsored
all the development.

== Installation

* install the plugin

    ./script/plugin install git://github.com/astrails/clicktale.git

* head to http://clicktale.com and signup for a free account. Or not free. Your
  choice.

* get a tracking code from clicktale. It should look something like this:

** Top part
    <!-- ClickTale Top part -->
    <script type="text/javascript">
    var WRInitTime=(new Date()).getTime();
    </script>
    <!-- ClickTale end of Top part -->

** Bottom part
    <!-- ClickTale Bottom part -->
    <div id="ClickTaleDiv" style="display: none;"></div>
    <script type='text/javascript'>
      document.write(unescape("%3Cscript%20src='"+
       (document.location.protocol=='https:'?
        'https://clicktale.pantherssl.com/':
        'http://s.clicktale.net/')+
        "WRc5.js'%20type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var ClickTaleSSL=1;
      if(typeof ClickTale=='function') ClickTale(<project_id>, <ratio>, <param>);
    </script>
    <!-- ClickTale end of Bottom part -->

* Copy the top script part into the "top:" section of the autogenerated
  config/clicktale.yml

* Copy the bottom script part into the "bottom:" section of the autogenerated
  config/clicktale.yml and make sure that it is properly escaped according to
  YAML format reference. As of now, i put single quotes around the whole script
  and then added another single quote for each single quote already present in
  the script(4 places).

  Alternatively, you can use the template that already present in the
  config/clicktale.yml file and replace <project_id>, <ratio> and <param> with
  your data that you got from clicktale.

=== You're done. Happy clicktailing.

Note: The plugin works by leveraging rails caching mechanism, which is by
default only enabled in production environment. To enable the plugin in the
development environment do the following:

	* set enabled=true in config/clicktale.yml (development section)
  * set config.action_controller.perform_caching=true in
    config/environments/development.rb

== Configuration Options

=== do_not_replace 
  Use the commented out example to add ruby regular expression that will
  prevent recording matching pages.  One use case would be preventing recording
  of admin pages.

=== insert_after and insert_before
  Top part of the clicktale script will be inserted after match of the
  insert_after regexp. By default it's <body>. 
  Bottom part of the clicktale script will be inserted before match of the
  insert_before regexp. By default it's </body>.

=== allowed_addresses
  If left empty, the recordings will be stored in the public/clicktale
  directory in your application directory. The name of the file will be long
  random hash and only those that can guess it (like, no one) will be able to
  access it. But, still, technically those files could be accessed from the
  wide internets, potentially revealing stuff that you would not want to be revealed.

  If you feeling a bit paranoid, you can provide comma separated list of IP
  addresses (CIDR notation, like in aaa.bbb.ccc.ddd/n, is supported) the
  recording will be handed only to requests from matching IPs.  Now it's all
  cool and secure and stuff, but it will cost you a performance hit. See, now
  each request that's coming from clicktale to pick up recording requires the
  whole rails stack to catch it, parse it, do it's magic and then check whether
  the IP is ok. Without the check rails even don't get loaded, everything
  handled by web server.

=== do_not_process_cookie_name and do_not_process_cookie_value
  Specifies the cookie to watch for to skip recording if clicktale decided that
  it's not recording this user for some reason. Usually the reason is that you
  asked it not to record all your requests, but some percentage of them. The
  default value is what works now.

== Copyright

Copyright (c) 2011 Michael Mazyar (Astrails Ltd.). Licensed under the MIT
license. See LICENSE for details.
